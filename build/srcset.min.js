(function(t){function e(t){this.imageCandidates=[],this.srcValue=t.src,this.srcsetValue=t.srcset,this.isValid=!0,this.error="",this._parse(this.srcsetValue),this.isValid||console.error("Error: "+this.error)}function n(t){this.src=t.src,this.w=t.w||1/0,this.h=t.h||1/0,this.x=t.x||1}var i=/^[0-9]+$/;e.prototype._parse=function(){for(var t,e,i=this.srcsetValue,r=0,s=[];""!==i;){for(;" "===i.charAt(0);)i=i.slice(1);if(r=i.indexOf(" "),-1!==r){if(t=i.slice(0,r),""===t)break;i=i.slice(r+1),r=i.indexOf(","),-1===r?(e=i,i=""):(e=i.slice(0,r),i=i.slice(r+1)),s.push({url:t,descriptors:e})}else s.push({url:i,descriptors:""}),i=""}for(var a=0,o=s.length;o>a;a++){var h=s[a],c=this._parseDescriptors(h.descriptors);this._addCandidate(new n({src:h.url,x:c.x,w:c.w,h:c.h}))}this.srcValue&&this._addCandidate(new n({src:this.srcValue}))},e.prototype._addCandidate=function(t){for(var e=0;this.imageCandidates.length>e;e++){var n=this.imageCandidates[e];if(n.x==t.x&&n.w==t.w&&n.h==t.h)return}this.imageCandidates.push(t)},e.prototype._parseDescriptors=function(t){for(var e=t.split(/\s/),n={},r=0;e.length>r;r++){var s=e[r];if(s.length>0){var a=s[s.length-1],o=s.substring(0,s.length-1),h=parseInt(o,10),c=parseFloat(o);o.match(i)&&"w"===a?n[a]=h:o.match(i)&&"h"==a?n[a]=h:isNaN(c)||"x"!=a?(this.error='Invalid srcset descriptor found in "'+s+'".',this.isValid=!1):n[a]=c}}return n},t.SrcsetInfo=e})(window),function(t){function e(){this.w=null,this.h=null,this.x=null}e.prototype.compute=function(){this.w=window.innerWidth||document.documentElement.clientWidth,this.h=window.innerHeight||document.documentElement.clientHeight,this.x=window.devicePixelRatio},e.prototype.setForTesting=function(t){this.w=t.w,this.h=t.h,this.x=t.x},e.prototype.getBestImage=function(t){var e=t.imageCandidates.slice(0),n=this._getBestCandidateIf(e,function(t,e){return t.w>e.w});this._removeCandidatesIf(e,function(t){return function(e){return e.w<t.w}}(this)),0===e.length&&(e=[n]);var i=this._getBestCandidateIf(e,function(t,e){return t.h>e.h});this._removeCandidatesIf(e,function(t){return function(e){return e.h<t.h}}(this)),0===e.length&&(e=[i]);var r=this._getBestCandidateIf(e,function(t,e){return t.x>e.x});this._removeCandidatesIf(e,function(t){return function(e){return e.x<t.x}}(this)),0===e.length&&(e=[r]);var s=this._getBestCandidateIf(e,function(t,e){return t.w<e.w});this._removeCandidatesIf(e,function(t){return t.w>s.w}),this._getBestCandidateIf(e,function(t,e){return t.h<e.h}),this._removeCandidatesIf(e,function(t){return t.h>s.h});var a=this._getBestCandidateIf(e,function(t,e){return t.x<e.x});return this._removeCandidatesIf(e,function(t){return t.x>a.x}),e[0]},e.prototype._getBestCandidateIf=function(t,e){for(var n=t[0],i=0;t.length>i;i++){var r=t[i];e(r,n)&&(n=r)}return n},e.prototype._removeCandidatesIf=function(t,e){for(var n=t.length-1;n>=0;n--){var i=t[n];e(i)&&t.splice(n,1)}return t},e.prototype.getBestImage2=function(t){for(var e=null,n=t.imageCandidates,i=0;n.length>i;i++){var r=n[i],s=e?e.x:0;if(r.x>=s&&r.x<=this.x){if(null===e){e=r;continue}this.w<=r.w&&r.w<=e.w&&(e=r)}}return e},t.ViewportInfo=e}(window),function(){function t(){var t=new Image;return"srcset"in t}function e(){if(!t()){var e=new ViewportInfo;e.compute();for(var n=document.querySelectorAll("img"),i=0;n.length>i;i++){var r=n[i],s=r.getAttribute("srcset");if(s){var a=new SrcsetInfo({src:r.src,srcset:s}),o=e.getBestImage(a);r.src=o.src}}}}var n=setInterval(function(){"complete"===document.readyState&&(e(),clearInterval(n))},10)}(window);